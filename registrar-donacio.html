<!DOCTYPE html>
<html lang="ca">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registrar Donaci贸 - Banc de Sang</title>
    <link rel="stylesheet" href="styles/theme.css">
    <link rel="stylesheet" href="styles/registrar-donacio.css">
    <link rel="stylesheet" href="styles/modal.css">
</head>

<body>
    <header>
        <div class="header-left">
            <button class="back-btn" onclick="window.location.href='xat.html'">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7" />
                </svg>
                Tornar
            </button>
        </div>
        <h1 class="header-title">Registra la teva donaci贸</h1>
        <div class="header-right">
            <!-- Perfil (nuevo) -->
            <button class="icon-btn" id="profileBtn" title="Perfil" onclick="location.href='personalizacion.html'">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
            </button>
        </div>
    </header>

    <main>
        <div class="register-container">
            <div class="register-header">
                <h1>Com vols registrar la teva donaci贸?</h1>
                <p>Escull el m猫tode que prefereixis per registrar la teva donaci贸 de sang</p>
            </div>

            <div class="register-methods">
                <button class="register-btn form-btn" id="manualFormBtn">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="12" y1="18" x2="12" y2="12"></line>
                        <line x1="9" y1="15" x2="15" y2="15"></line>
                    </svg>
                    <div class="btn-content">
                        <span class="btn-title">Omplir formulari</span>
                        <span class="btn-description">Introdueix manualment les dades de la donaci贸</span>
                    </div>
                </button>

                <button class="register-btn code-btn" id="codeFormBtn">
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                        <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                    </svg>
                    <div class="btn-content">
                        <span class="btn-title">Introduir codi</span>
                        <span class="btn-description">Utilitza el codi del teu comprovant de donaci贸</span>
                    </div>
                </button>
            </div>

            <div class="recent-donations">
                <h5>ltima donaci贸 registrada:</h5>
                <div class="last-donation-info" id="lastDonationInfo">
                    <p>Encara no has registrat cap donaci贸</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Modal de registre de donaci贸 -->
    <div class="modal-overlay" id="donationModal">
        <div class="modal-container">
            <div class="modal-header">
                <h3>Formulari de donaci贸 de sang</h3>
                <button class="modal-close" id="closeModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="donationForm">
                    <div class="form-group">
                        <label for="donationDate">Data de la donaci贸 *</label>
                        <input type="date" id="donationDate" required>
                    </div>

                    <div class="form-group">
                        <label for="donationCenter">Centre de donaci贸 *</label>
                        <select id="donationCenter" required>
                            <option value="">Selecciona un centre</option>
                            <option value="Banc de Sang i Teixits - Barcelona">Banc de Sang i Teixits - Barcelona
                            </option>
                            <option value="Hospital Universitari Vall d'Hebron - Barcelona">Hospital Universitari Vall
                                d'Hebron - Barcelona</option>
                            <option value="Hospital de la Santa Creu i Sant Pau - Barcelona">Hospital de la Santa Creu i
                                Sant Pau - Barcelona</option>
                            <option value="Hospital Cl铆nic - Barcelona">Hospital Cl铆nic - Barcelona</option>
                            <option value="Hospital Germans Trias i Pujol - Badalona">Hospital Germans Trias i Pujol -
                                Badalona</option>
                            <option value="Hospital Universitari de Bellvitge - L'Hospitalet">Hospital Universitari de
                                Bellvitge - L'Hospitalet</option>
                            <option value="Fundaci贸 Althaia - Hospital Sant Joan de D茅u - Manresa">Fundaci贸 Althaia -
                                Hospital Sant Joan de D茅u - Manresa</option>
                            <option value="Hospital Universitari M煤tua Terrassa - Terrassa">Hospital Universitari M煤tua
                                Terrassa - Terrassa</option>
                            <option value="Hospital Universitari de Girona Doctor Josep Trueta - Girona">Hospital
                                Universitari de Girona Doctor Josep Trueta - Girona</option>
                            <option value="Hospital Universitari Arnau de Vilanova - Lleida">Hospital Universitari Arnau
                                de Vilanova - Lleida</option>
                            <option value="Hospital Universitari Joan XXIII - Tarragona">Hospital Universitari Joan
                                XXIII - Tarragona</option>
                            <option value="Hospital Verge de la Cinta - Tortosa">Hospital Verge de la Cinta - Tortosa
                            </option>
                            <option value="Hospital Universitari Sant Joan de Reus - Reus">Hospital Universitari Sant
                                Joan de Reus - Reus</option>
                            <option value="other">Altre centre...</option>
                        </select>
                    </div>

                    <div class="form-group" id="otherCenterGroup" style="display: none;">
                        <label for="otherCenter">Especifica el centre *</label>
                        <input type="text" id="otherCenter" placeholder="Nom del centre de donaci贸">
                    </div>

                    <div class="form-group">
                        <label for="donationType">Tipus de donaci贸 *</label>
                        <select id="donationType" required>
                            <option value="Sang">Sang</option>
                            <option value="Plasma">Plasma</option>
                        </select>
                    </div>

                    <div class="form-group" id="volumeGroup">
                        <label for="donationVolume">Volum donat (ml)</label>
                        <input type="number" id="donationVolume" value="450" min="450" max="470" step="10">
                        <small style="color: #666; display: block; margin-top: 0.5rem;">
                            La donaci贸 de sang 茅s entre 450 ml i 470 ml
                        </small>
                    </div>

                    <div class="form-group">
                        <label for="observations">Observacions (opcional)</label>
                        <textarea id="observations" rows="3"
                            placeholder="Qualsevol comentari o observaci贸 sobre la donaci贸..."></textarea>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn-cancel" id="cancelFormBtn">Cancel路lar</button>
                        <button type="submit" class="btn-submit">Registrar Donaci贸</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal d'introducci贸 de codi -->
    <div class="modal-overlay" id="codeModal">
        <div class="modal-container">
            <div class="modal-header">
                <h3>Introdueix el codi de donaci贸</h3>
                <button class="modal-close" id="closeCodeModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="code-explanation">
                    <h4> Com funciona el codi de donaci贸?</h4>
                    <p>Despr茅s de fer una donaci贸, rebrs un comprovant amb un codi 煤nic que pots utilitzar per
                        registrar-la rpidament a l'aplicaci贸.</p>

                    <div class="code-format-info">
                        <strong>Format del codi:</strong>
                        <div class="code-example">
                            <span class="code-part prefix">BST</span>
                            <span class="code-separator">-</span>
                            <span class="code-part year">20251108</span>
                            <span class="code-separator">-</span>
                            <span class="code-part number">123456</span>
                        </div>
                        <ul class="code-parts-description">
                            <li><strong>BST:</strong> Codi del centre de donaci贸 (3 lletres)</li>
                            <li><strong>20251108:</strong> Data de la donaci贸 (AAAAMMDD)</li>
                            <li><strong>123456:</strong> N煤mero de registre (6 xifres)</li>
                        </ul>
                    </div>

                    <div class="centers-list">
                        <strong>Codis de centres:</strong>
                        <div class="centers-grid">
                            <span><strong>BST</strong> - Banc de Sang i Teixits - Barcelona</span>
                            <span><strong>HVH</strong> - Hospital Vall d'Hebron - Barcelona</span>
                            <span><strong>HSP</strong> - Hospital Santa Creu i Sant Pau - Barcelona</span>
                            <span><strong>HCB</strong> - Hospital Cl铆nic - Barcelona</span>
                            <span><strong>HGT</strong> - Hospital Germans Trias i Pujol - Badalona</span>
                            <span><strong>HBV</strong> - Hospital de Bellvitge - L'Hospitalet</span>
                            <span><strong>HSJ</strong> - Hospital Sant Joan de D茅u - Manresa</span>
                            <span><strong>HMT</strong> - Hospital M煤tua Terrassa - Terrassa</span>
                            <span><strong>HGI</strong> - Hospital de Girona Doctor Josep Trueta - Girona</span>
                            <span><strong>HAV</strong> - Hospital Arnau de Vilanova - Lleida</span>
                            <span><strong>HJ3</strong> - Hospital Joan XXIII - Tarragona</span>
                            <span><strong>HVC</strong> - Hospital Verge de la Cinta - Tortosa</span>
                            <span><strong>HSR</strong> - Hospital Sant Joan de Reus - Reus</span>
                        </div>
                    </div>
                </div>

                <form id="codeForm">
                    <div class="form-group">
                        <label for="donationCode">Codi de donaci贸 *</label>
                        <input type="text" id="donationCode" required placeholder="Exemple: BST-20251108-123456"
                            pattern="[A-Z]{3}-[0-9]{8}-[0-9]{6}"
                            title="Format: XXX-AAAAMMDD-XXXXXX (Ex: BST-20251108-123456)">
                        <small style="color: #666; display: block; margin-top: 0.5rem;">
                            Introdueix el codi que apareix al teu comprovant de donaci贸
                        </small>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn-cancel" id="cancelCodeBtn">Cancel路lar</button>
                        <button type="submit" class="btn-submit">Validar i Registrar</button>
                    </div>
                </form>

                <div id="codeError"
                    style="display: none; color: #d32f2f; margin-top: 1rem; padding: 1rem; background: #ffebee; border-radius: 4px;">
                    <strong>锔 Codi invlid</strong>
                    <p style="margin: 0.5rem 0 0 0;">El codi introdu茂t no 茅s vlid o ja ha estat utilitzat.</p>
                </div>
            </div>
        </div>
    </div>

    <script src="scripts/user-data-manager.js"></script>
    <script src="scripts/auth.js"></script>
    <script src="scripts/theme-manager.js"></script>
    <script src="scripts/modal.js"></script>
    <script src="scripts/registrar-donacio.js"></script>
</body>

</html>